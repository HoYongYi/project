<!DOCTYPE html>
<html>

<head>
    <title>Health Center</title>
    <style type="text/css" title="layout" media="screen"> @import url("style.css"); </style>
    <style type="text/css" title="layout" media="screen"> @import url("video.css"); </style>
    <script src='js/adapter.js'></script>

</head>

<body>
<div id="wrapper">
    <div id="top">
        <div id="logo">
            <img src="images/plus.gif" alt="Logo"/>
            <h1>Health Center</h1>
            <p>DELIVERING ONLY PREMIUM SERVICES</p>
        </div>
    </div>
    <form action="action_page.php">
        <div class="imgcontainer">
        </div>

        <li></li>

        <div class="container">
            <input type="text" placeholder="Enter Username" name="loginID" required>

            <input type="password" placeholder="Enter Password" name="password" required>

            <span class="psw"><a href="#">Forgot password?</a></span>
        </div>
    </form>
    <div id="menu">
        <ul>
            <li><a href="#">About</a></li>
            <li><a href="#">Patient Care and Health Information</a></li>
            <li><a href="#">News and Events</a></li>
            <li><a href="#">Department and Centers</a></li>
            <li><a href="#">Product and Services</a></li>
            <li><a href="#">Contact Us</a></li>
        </ul>
    </div>

    <div class = 'videoContainer'>
        <video id="localVideo" autoplay muted height="40%" width="40%"></video>
        <video id="remoteVideo" autoplay muted height="40%" width="40%"></video>

    </div>




    <div>
        <button id="startButton">Start</button>
        <button id="callButton">Call</button>
        <button id="hangupButton">Hang Up</button>


    </div>

    <textarea id="dataChannelSend" disabled></textarea>
    <textarea id="dataChannelReceive" disabled></textarea>

    <div id="buttons">
        <button id="startChatButton">Start Chat</button>
        <button id="sendButton">Send</button>
        <button id="closeButton">Stop</button>
    </div>
    <div class="cleaner">&nbsp;</div>
    <div class="line">
        &nbsp;</div>
    <div id="footer">
        &copy; 2008 <a href="index.html">Designs.com</a>. Valid <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a> &amp; <a href="http://validator.w3.org/check?uri=referer">XHTML</a>. Template design by <a href="http://gendesigns.blogspot.com">Gen</a>
    </div>

    //Video Script
    <script>
        var localStream, localPeerConnection, remotePeerConnection;

        var localVideo = document.getElementById("localVideo");
        var remoteVideo = document.getElementById("remoteVideo");

        var startButton = document.getElementById("startButton");
        var callButton = document.getElementById("callButton");
        var hangupButton = document.getElementById("hangupButton");
        startButton.disabled = false;
        callButton.disabled = true;
        hangupButton.disabled = true;
        startButton.onclick = start;
        callButton.onclick = call;
        hangupButton.onclick = hangup;

        function trace(text) {
            console.log((performance.now() / 1000).toFixed(3) + ": " + text);
        }

        function gotStream(stream){
            trace("Received local stream");
            localVideo.src = URL.createObjectURL(stream);
            localStream = stream;
            callButton.disabled = false;
        }

        function start() {
            trace("Requesting local stream");
            startButton.disabled = true;
            getUserMedia({audio:true, video:true}, gotStream,
                    function(error) {
                        trace("getUserMedia error: ", error);
                    });
        }

        function call() {
            callButton.disabled = true;
            hangupButton.disabled = false;
            trace("Starting call");

            if (localStream.getVideoTracks().length > 0) {
                trace('Using video device: ' + localStream.getVideoTracks()[0].label);
            }
            if (localStream.getAudioTracks().length > 0) {
                trace('Using audio device: ' + localStream.getAudioTracks()[0].label);
            }

            var servers = null;

            localPeerConnection = new RTCPeerConnection(servers);
            trace("Created local peer connection object localPeerConnection");
            localPeerConnection.onicecandidate = gotLocalIceCandidate;

            remotePeerConnection = new RTCPeerConnection(servers);
            trace("Created remote peer connection object remotePeerConnection");
            remotePeerConnection.onicecandidate = gotRemoteIceCandidate;
            remotePeerConnection.onaddstream = gotRemoteStream;

            localPeerConnection.addStream(localStream);
            trace("Added localStream to localPeerConnection");
            localPeerConnection.createOffer(gotLocalDescription,handleError);
        }

        function gotLocalDescription(description){
            localPeerConnection.setLocalDescription(description);
            trace("Offer from localPeerConnection: \n" + description.sdp);
            remotePeerConnection.setRemoteDescription(description);
            remotePeerConnection.createAnswer(gotRemoteDescription,handleError);
        }

        function gotRemoteDescription(description){
            remotePeerConnection.setLocalDescription(description);
            trace("Answer from remotePeerConnection: \n" + description.sdp);
            localPeerConnection.setRemoteDescription(description);
        }

        function hangup() {
            trace("Ending call");
            localPeerConnection.close();
            remotePeerConnection.close();
            localPeerConnection = null;
            remotePeerConnection = null;
            hangupButton.disabled = true;
            callButton.disabled = false;
        }

        function gotRemoteStream(event){
            remoteVideo.src = URL.createObjectURL(event.stream);
            trace("Received remote stream");
        }

        function gotLocalIceCandidate(event){
            if (event.candidate) {
                remotePeerConnection.addIceCandidate(new RTCIceCandidate(event.candidate));
                trace("Local ICE candidate: \n" + event.candidate.candidate);
            }
        }

        function gotRemoteIceCandidate(event){
            if (event.candidate) {
                localPeerConnection.addIceCandidate(new RTCIceCandidate(event.candidate));
                trace("Remote ICE candidate: \n " + event.candidate.candidate);
            }
        }

        function handleError(){}
    </script>
    //Textbox script
    <script>
        var sendChannel, receiveChannel;

        startChatButton.onclick = createConnection;
        sendButton.onclick = sendData;
        closeButton.onclick = closeDataChannels;

        function createConnection() {
            var servers = null;
            window.localPeerConnection = new RTCPeerConnection(servers,
                    {optional: [{RtcDataChannels: true}]});
            trace('Created local peer connection object localPeerConnection');

            try {
                // Reliable Data Channels not yet supported in Chrome
                sendChannel = localPeerConnection.createDataChannel("sendDataChannel",
                        {reliable: false});
                trace('Created send data channel');
            } catch (e) {
                alert('Failed to create data channel. ' +
                        'You need Chrome M25 or later with RtpDataChannel enabled');
                trace('createDataChannel() failed with exception: ' + e.message);
            }
            localPeerConnection.onicecandidate = gotLocalCandidate;
            sendChannel.onopen = handleSendChannelStateChange;
            sendChannel.onclose = handleSendChannelStateChange;

            window.remotePeerConnection = new RTCPeerConnection(servers,
                    {optional: [{RtcDataChannels: true}]});
            trace('Created remote peer connection object remotePeerConnection');

            remotePeerConnection.onicecandidate = gotRemoteIceCandidate;
            remotePeerConnection.ondatachannel = gotReceiveChannel;

            localPeerConnection.createOffer(gotLocalDescription,handleError);
            startButton.disabled = true;
            closeButton.disabled = false;
        }

        function sendData() {
            var data = document.getElementById("dataChannelSend").value;
            sendChannel.send(data);
            trace('Sent data: ' + data);
        }

        function closeDataChannels() {
            trace('Closing data channels');
            sendChannel.close();
            trace('Closed data channel with label: ' + sendChannel.label);
            receiveChannel.close();
            trace('Closed data channel with label: ' + receiveChannel.label);
            localPeerConnection.close();
            remotePeerConnection.close();
            localPeerConnection = null;
            remotePeerConnection = null;
            trace('Closed peer connections');
            startButton.disabled = false;
            sendButton.disabled = true;
            closeButton.disabled = true;
            dataChannelSend.value = "";
            dataChannelReceive.value = "";
            dataChannelSend.disabled = true;
            dataChannelSend.placeholder = "Press Start, enter some text, then press Send.";
        }

        function gotLocalCandidate(event) {
            trace('local ice callback');
            if (event.candidate) {
                remotePeerConnection.addIceCandidate(event.candidate);
                trace('Local ICE candidate: \n' + event.candidate.candidate);
            }
        }

        function gotReceiveChannel(event) {
            trace('Receive Channel Callback');
            receiveChannel = event.channel;
            receiveChannel.onmessage = handleMessage;
            receiveChannel.onopen = handleReceiveChannelStateChange;
            receiveChannel.onclose = handleReceiveChannelStateChange;
        }

        function handleMessage(event) {
            trace('Received message: ' + event.data);
            document.getElementById("dataChannelReceive").value = event.data;
        }

        function handleSendChannelStateChange() {
            var readyState = sendChannel.readyState;
            trace('Send channel state is: ' + readyState);
            if (readyState == "open") {
                dataChannelSend.disabled = false;
                dataChannelSend.focus();
                dataChannelSend.placeholder = "";
                sendButton.disabled = false;
                closeButton.disabled = false;
            } else {
                dataChannelSend.disabled = true;
                sendButton.disabled = true;
                closeButton.disabled = true;
            }
        }

        function handleReceiveChannelStateChange() {
            var readyState = receiveChannel.readyState;
            trace('Receive channel state is: ' + readyState);
        }

        function handleError(){}
    </script>



</div>
</body>

</html>
